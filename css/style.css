/* css/style.css - Maktabat AlAysaei (الإصدار المدمج والنهائي) */

/* ------------------ الثوابت والتصميم الأساسي ------------------ */
:root {
  --bg: #0f0d0b;           /* خلفية التطبيق - غامق جدًا */
  --card: #151412;         /* خلفية البطاقات والنوافذ - أغمق قليلاً */
  --accent: #d4af37;       /* لون التمييز (الذهبي/البرونزي) */
  --muted: #cfc6b6;        /* لون النص الأساسي - بيج هادئ */
  --line: #2b2724;         /* لون الحدود والفواصل */
  --error: #e57373;        /* لون الأخطاء (أحمر) */
  --success: #81c784;      /* لون النجاح (أخضر) */
  --neutral: #6a6a6a;      /* لون الرسائل الحيادية */
  --transition-speed: 0.2s; /* سرعة الانتقال الافتراضية */
}

/* إعادة ضبط المتصفح والخطوط */
* {
  box-sizing: border-box;
  transition: all var(--transition-speed) ease; /* تأثير انتقالي سلس لجميع العناصر */
}
html, body {
  height: 100%;
  margin: 0;
  font-family: Tahoma, Arial, sans-serif;
  background: var(--bg);
  color: var(--muted);
  direction: rtl;
}

.app {
  max-width: 1200px;
  margin: 12px auto;
  padding: 0 12px;
  min-height: calc(100vh - 24px); /* لضمان أن الفوتر يصل للأسفل */
  display: flex;
  flex-direction: column;
}

/* ------------------ الشريط العلوي (Topbar) ------------------ */
.topbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px;
  background: var(--card);
  border-radius: 10px;
  border: 1px solid var(--line);
}
.brand {
  display: flex;
  gap: 12px;
  align-items: center;
}
.logo {
  font-size: 28px;
}
.title {
  font-size: 18px;
  color: var(--accent);
  font-weight: 800;
}
.small {
  font-size: 11px;
  color: var(--neutral);
}
.actions {
  display: flex;
  gap: 8px;
  align-items: center;
}
.icon-btn {
  background: transparent;
  border: 1px solid var(--line);
  color: var(--muted);
  padding: 8px 10px;
  border-radius: 8px;
  cursor: pointer;
}
.icon-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}
.install-btn {
  display: none; /* يتم إظهاره بواسطة app.js فقط عند الحاجة */
}

/* ------------------ شريط الأيقونات (Icon Strip) ------------------ */
.icon-strip {
  margin-top: 10px;
  overflow-x: auto;
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}
.icon-strip::-webkit-scrollbar { /* Chrome, Safari */
    display: none;
}
.strip-inner {
  display: flex;
  gap: 10px;
  padding-bottom: 5px; /* لتفادي قطع الظل أو الشريط */
}
.strip-inner .item {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 8px 10px;
  background: var(--card);
  border-radius: 8px;
  border: 1px solid var(--line);
  cursor: pointer;
  flex-shrink: 0;
}
.strip-inner .item:hover {
  background: var(--line);
}
.strip-inner .item.active {
  border-color: var(--accent);
  box-shadow: 0 0 5px rgba(212, 175, 55, 0.5);
}
.strip-inner .item .icon {
  font-size: 22px;
  margin-bottom: 4px;
}
.strip-inner .item .label {
  font-size: 12px;
  white-space: nowrap;
}

/* ------------------ شريط البحث (Search) ------------------ */
.search-row {
  display: flex;
  gap: 8px;
  margin-top: 10px;
}
.search-input {
  flex-grow: 1;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid var(--line);
  background: var(--card);
  color: var(--muted);
  font-size: 14px;
}
.search-icon {
  background: var(--card);
  border: 1px solid var(--line);
  color: var(--muted);
  padding: 10px 15px;
  border-radius: 8px;
  cursor: pointer;
}
.search-icon:hover {
  border-color: var(--accent);
}

/* ------------------ التخطيط الرئيسي (Layout) ------------------ */
.layout {
  display: flex;
  gap: 10px;
  margin-top: 10px;
  flex-grow: 1; /* للسماح للوحة بالنمو و دفع الفوتر للأسفل */
}
.left-panel {
  width: 300px;
  min-height: 400px;
  background: var(--card);
  border-radius: 10px;
  padding: 12px;
  border: 1px solid var(--line);
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
}
.right-panel {
  flex-grow: 1;
  background: var(--card);
  border-radius: 10px;
  padding: 12px;
  border: 1px solid var(--line);
  display: flex;
  flex-direction: column;
}
.panel-title {
  color: var(--accent);
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 8px;
  padding-bottom: 5px;
  border-bottom: 1px solid var(--line);
}

/* ------------------ الفهرس (Index) ------------------ */
.index-window {
  overflow-y: auto;
  flex-grow: 1;
}

.index-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px;
  border-radius: 6px;
  margin-bottom: 4px;
  cursor: pointer;
}
.index-item:hover {
  background: var(--line);
}
.index-item.active {
  background: var(--accent);
  color: var(--bg);
}
.index-item.active .dots {
  color: var(--bg);
}
.index-item .dots {
  font-size: 16px;
  color: var(--neutral);
  padding: 0 4px;
}

.index-group-name {
    font-weight: bold;
    color: var(--accent);
    padding: 6px 0;
    margin-top: 5px;
    cursor: pointer;
}
.index-group-name:hover {
    text-decoration: underline;
}

/* ------------------ العارض (Viewer) ------------------ */
.viewer-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--line);
}
.viewer-head .row {
  display: flex;
  gap: 8px;
  align-items: center;
}
.viewer-title {
  font-size: 20px;
  color: var(--accent);
  font-weight: bold;
}
.viewer {
  padding: 15px 0;
  overflow-y: auto;
  flex-grow: 1;
}

/* ------------------ تنسيقات محتوى العارض القانوني ------------------ */

/* تصفير العداد قبل البدء */
.viewer {
    counter-reset: p-counter;
}

/* ترقيم الفقرات داخل العارض */
.viewer p {
    margin-top: 1em;
    padding-right: 25px; /* مساحة لـ "المادة (رقم)" */
    position: relative;
    line-height: 1.8;
}

/* إضافة رقم المادة/الفقرة */
.viewer p:before {
    counter-increment: p-counter;
    content: "المادة (" counter(p-counter) ") ";
    font-weight: bold;
    color: var(--accent);
    position: absolute;
    right: 0;
    top: 0;
}

/* لإلغاء الترقيم التلقائي لفقرة معينة */
.viewer p.no-number:before {
    content: "";
    counter-increment: none;
    padding-right: 0;
}
.viewer p.no-number {
    padding-right: 0;
}

.viewer h1, .viewer h2, .viewer h3 {
    color: var(--accent);
    margin-top: 20px;
    margin-bottom: 10px;
    counter-reset: none; /* التأكد من عدم تأثير العداد على العناوين */
}

/* ------------------ الأزرار (Buttons) ------------------ */
.btn {
  padding: 8px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  border: 1px solid transparent;
}
.btn.primary {
  background: var(--accent);
  color: var(--bg);
}
.btn.primary:hover {
  opacity: 0.9;
}
.btn.neutral {
  background: var(--card);
  color: var(--muted);
  border-color: var(--line);
}
.btn.neutral:hover {
  background: var(--line);
}
.btn.error {
    background: var(--error);
    color: white;
    border-color: var(--error);
}
.btn.error:hover {
    opacity: 0.9;
}

/* ------------------ النوافذ المنبثقة (Modals) ------------------ */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
  display: none; /* يتم التحكم بها بواسطة JS */
  justify-content: center;
  align-items: center;
  z-index: 1000;
  backdrop-filter: blur(5px);
}
.modal.show {
  display: flex;
}
.modal-content, .card {
  background: var(--card);
  padding: 20px;
  border-radius: 10px;
  border: 1px solid var(--line);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
  width: 90%;
  max-width: 600px;
  text-align: right;
  position: relative;
  overflow: auto; /* للسماح بالتمرير داخل النوافذ الكبيرة */
  max-height: 90vh;
}
.card {
    padding: 15px;
}
.modal-content input, .modal-content textarea, .card input, .card textarea {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid var(--line);
    background: #0b0a09;
    color: var(--muted);
    margin-top: 8px;
    resize: vertical;
}

/* ------------------ تنسيقات لوحة الإدارة ------------------ */
.admin-index-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px;
    border-bottom: 1px solid var(--line);
    margin-bottom: 5px;
}
.admin-index-item:hover {
    background: var(--line);
    border-radius: 4px;
}
.admin-index-item .actions button {
    margin-right: 5px;
}
.admin-index-list {
    max-height: 300px;
    overflow-y: auto;
}


/* ------------------ قائمة السياق (Context Menu) ------------------ */
.menu {
    position: fixed;
    background: var(--card);
    border: 1px solid var(--line);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    padding: 5px 0;
    z-index: 2000;
    min-width: 150px;
}
.menu button {
    display: block;
    width: 100%;
    text-align: right;
    background: transparent;
    border: none;
    color: var(--muted);
    padding: 8px 15px;
    cursor: pointer;
    font-size: 14px;
}
.menu button:hover {
    background: var(--line);
    color: var(--accent);
}

/* ------------------ الرسائل العائمة (Toast/Message) ------------------ */
#message-container {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 3000;
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 90%;
}
.message {
    padding: 10px 15px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    font-weight: bold;
    opacity: 0;
    transform: translateY(-20px);
    transition: opacity 0.3s ease, transform 0.3s ease;
}
.message.show {
    opacity: 1;
    transform: translateY(0);
}
.message.error {
    background: var(--error);
    color: white;
}
.message.success {
    background: var(--success);
    color: var(--bg);
}
.message.neutral { /* رسائل حالة العمليات */
    background: var(--neutral);
    color: white;
}

/* ------------------ الفوتر (Footer) ------------------ */
.footer {
  text-align: center;
  padding: 10px;
  font-size: 12px;
  color: var(--neutral);
  margin-top: 20px;
}

/* ------------------ تنسيق المراسلة والمرفقات ------------------ */
.contact-form-card {
    background: var(--bg);
    padding: 12px;
    border-radius: 8px;
    border: 1px solid var(--line);
}
.row {
    display: flex;
    align-items: center;
    gap: 10px;
}
.attachment-tag {
    background: var(--line);
    color: var(--muted);
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 5px;
    margin-bottom: 5px;
}
.attachment-tag button {
    background: none;
    border: none;
    color: var(--error);
    cursor: pointer;
    font-weight: bold;
}
/* تنسيق العناصر المحذوفة في لوحة الإدارة */
.admin-index-item.deleted {
    background-color: rgba(229, 115, 115, 0.1); /* ظل أحمر خفيف */
    border-color: var(--error);
    opacity: 0.7;
    text-decoration: line-through;
}


/* ------------------ استجابة الشاشات (Media Queries) ------------------ */

@media (max-width: 900px) {
  .layout {
    flex-direction: column;
  }
  .left-panel, .right-panel {
    width: 100%;
    min-height: auto;
    padding: 10px;
  }
}

/* شاشات صغيرة جدًا (مثل الجوالات الرأسية) */
@media (max-width: 600px) {
  .app {
    padding: 8px;
    gap: 8px;
  }
  .topbar {
    flex-direction: column;
    align-items: flex-start;
  }
  .actions {
    margin-top: 8px;
    width: 100%;
    justify-content: space-around;
  }
  .actions button {
    flex-grow: 1;
  }
  .viewer-head {
      flex-direction: column;
      align-items: flex-end;
      gap: 8px;
  }
  .viewer-head .row:first-child {
      align-self: flex-start;
  }
  .viewer-head .row:last-child {
      width: 100%;
      justify-content: space-between;
  }
  .viewer-head .row:last-child button {
      flex-grow: 1;
  }
}

